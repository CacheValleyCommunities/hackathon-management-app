{{#if (eq (size results) 0)}}
<div class="text-center py-16">
    <p class="text-gray-500 text-lg">No results available yet. Scores need to be submitted first.</p>
</div>
{{else}}
{{#each results}}
<div class="mb-6">
    <!-- Division Header -->
    <div class="mb-2">
        <h2 class="text-base font-bold text-gray-900">{{@key}}</h2>
        <div class="mt-0.5 h-px bg-gray-200"></div>
    </div>

    <!-- Results List -->
    <div class="space-y-0">
        {{#each this}}
        <div
            class="flex items-center gap-2 py-1 px-2 text-xs hover:bg-gray-50 transition {{#if (eq rank 1)}}bg-yellow-50 border-l border-yellow-400{{else if (eq rank 2)}}bg-gray-50 border-l border-gray-400{{else if (eq rank 3)}}bg-orange-50 border-l border-orange-400{{else}}border-l border-transparent{{/if}}">
            <!-- Rank -->
            <div class="w-6 text-center flex-shrink-0">
                {{#if (eq rank 1)}}
                <span class="text-xs">ðŸ¥‡</span>
                {{else if (eq rank 2)}}
                <span class="text-xs">ðŸ¥ˆ</span>
                {{else if (eq rank 3)}}
                <span class="text-xs">ðŸ¥‰</span>
                {{else}}
                <span class="text-xs font-medium text-gray-500">{{rank}}</span>
                {{/if}}
            </div>

            <!-- Team Name -->
            <div class="flex-1 min-w-0">
                <span class="text-xs font-medium text-gray-900 truncate">{{team_name}}</span>
            </div>

            <!-- Table -->
            <div class="w-12 flex-shrink-0 text-xs text-gray-500">
                {{table_name}}
            </div>

            <!-- Metadata -->
            <div class="w-16 flex-shrink-0 text-xs text-gray-500">
                {{rounds_completed}}r â€¢ {{judge_count}}j
            </div>

            <!-- Score -->
            <div class="w-14 text-right flex-shrink-0">
                <span class="text-xs font-bold
                    {{#if (eq rank 1)}}text-yellow-700
                    {{else if (eq rank 2)}}text-gray-700
                    {{else if (eq rank 3)}}text-orange-700
                    {{else}}text-gray-900{{/if}}">
                    {{toFixed total_score 1}}
                </span>
            </div>
        </div>
        {{/each}}
    </div>
</div>
{{/each}}
{{/if}}

<!-- Category Leaders (hidden, extracted by JavaScript) -->
<div id="category-leaders-container" style="display: none;">
{{#if (gt (size categoryLeaders) 0)}}
<div class="space-y-4">
    {{#each categoryLeaders}}
    <div class="border border-gray-200 rounded-lg p-3 hover:bg-gray-50 transition">
        <div class="flex items-start justify-between mb-2">
            <h3 class="text-sm font-semibold text-gray-900">{{category_name}}</h3>
            <span class="text-xs text-yellow-600 font-medium">ðŸ¥‡</span>
        </div>
        <div class="space-y-1">
            <p class="text-sm font-medium text-gray-900 truncate">{{team_name}}</p>
            <p class="text-xs text-gray-500 truncate">{{project_name}}</p>
            <div class="flex items-center justify-between mt-2 pt-2 border-t border-gray-100">
                <span class="text-xs text-gray-500">{{table_name}}</span>
                <span class="text-xs font-bold text-gray-900">{{toFixed total_score 1}} pts</span>
            </div>
        </div>
    </div>
    {{/each}}
</div>
{{else}}
<div class="text-center py-8">
    <p class="text-sm text-gray-500">No category leaders yet.</p>
    <p class="text-xs text-gray-400 mt-1">Teams need scores and categories to appear here.</p>
</div>
{{/if}}
</div>